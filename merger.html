<html>
<head>
   <title>Datamerger beta (sucks)</title>
   
   <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
		
   <style>
   html, body, #map {
      height:100%;
      width:100%;
      padding:0px;
      margin:0px;
   } 
   </style>
   
 <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.css" />
   
 
 <script src="http://code.jquery.com/jquery-2.1.0.js" type="text/javascript"></script>
   <script language="javascript">
      function init() {
			
		function merge_json(arr1, arr2) {

		  var arry = [];
		  arr1.forEach(function(el1) {
			var el="nix";
			arr2.forEach(function(el2) {

				if (el1.id == el2.id) { el=el2; }
			} )
			if (el != "nix") {
				
				el1['wgs84-east'] = el['wgs84-east'];
				el1['wgs84-north'] = el['wgs84-north'];
				arry.push(el1);
			} else {
				alert("no x/y:" + el1.id)
			}
			
		  })
		  return arry;
		}	
			// coords array
			
         $.getJSON("coords.json", function(json) {
		
			var coords = eval( json );
			
			$.getJSON("kitadata.json", function(json) {
		
				var kitadata = eval( json );
				var merged = merge_json(kitadata.kitas,coords);
				//alert(JSON.stringify(merged));
				 document.getElementById('map').innerHTML = JSON.stringify(merged);

			});		
				
			
		});		
		
				

		
		
	
		
	
      }
   </script>
   
</head>
<body onLoad="javascript:init();">
   <div id="map"></div>
   
</body>                                                                                                                          
</html>
    
