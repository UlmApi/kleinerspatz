<html>
<head>
   <title>Kita Mapping Ulm</title>
   
   <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
		
   <style>
   html, body, #map {
      height:100%;
      width:100%;
      padding:0px;
      margin:0px;
   } 
   </style>
   
 <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.css" />
   
 <script src="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.js"></script>
 <script src="http://code.jquery.com/jquery-2.1.0.js" type="text/javascript"></script>
   <script language="javascript">
      function init() {
         var map = new L.Map('map');                       
              
      	 L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: 'Â© <a href="http://openstreetmap.org">OpenStreetMap</a> contributors',
            maxZoom: 18
         }).addTo(map);
         map.attributionControl.setPrefix(''); // Don't show the 'Powered by Leaflet' text.

         var ulm = new L.LatLng(48.40, 9.98); 
         map.setView(ulm, 13);


function iconInstance(name){
	return L.icon({
		iconUrl: "img/"+ name + ".png",
		shadowUrl: null,
		
		iconSize: [25,43],
		shadowSize: [0,0],
		iconAnchor: [25,43],
		shadowAnchor: [0,0],
		popupAnchor:[0,-40]
	});
}
		
		// Get JSON for Kitas real
         $.getJSON("kita_final.json", function(json) {
			console.log(json); // this will show the info it in firebug console
			data = eval( json );
			console.log(data);
			for (var i=0; i<data.length; i++) {
				if(i==1){console.log(data[i]);}
				iconname = "";
				if(data[i]['over3'] == null){
						iconname+="gray";
				}else switch(data[i]['over3']){
					case "true":
						iconname+="green";
						break;
					case "false":
						iconname+="red";
						break;
				}
				if(data[i]['under3'] == null){
						iconname+="gray";
				}else switch(data[i]['under3']){
					case "true":
						iconname+="green";
						break;
					case "false":
						iconname+="red";
						break;
					case null:
						iconname+="gray";
						break;
				}
				icon = iconInstance(iconname);

				var marker = L.marker([data[i]['wgs84-north'],data[i]['wgs84-east']], {'icon':icon}).addTo(map);
				popup = "<b>" + data[i]['name'] +  "</b>";
				popup += "<br><a target='_blank' href='http://suche.kita.ulm.de/homepage/einrichtung.php?id="+ data[i]['id'] +"'>mehr Informationen</a>";

				marker.bindPopup(popup);
			}	
			
		});		
		
	
      }
   </script>
   
</head>
<body onLoad="javascript:init();">
   <div id="map"></div>
   
   <div id="debug"></div>
</body>                                                                                                                          
</html>
    
